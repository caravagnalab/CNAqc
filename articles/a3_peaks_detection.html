<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>3. QC analysis via peaks detection • CNAqc</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="3. QC analysis via peaks detection">
<meta property="og:description" content="CNAqc">
<meta property="og:image" content="caravagn.github.io/CNAqc/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CNAqc</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/CNAqc.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/a1_Introduction.html">1. Introduction</a>
    </li>
    <li>
      <a href="../articles/a2_Plots.html">2. Plotting data</a>
    </li>
    <li>
      <a href="../articles/a3_peaks_detection.html">3. QC analysis via peaks detection</a>
    </li>
    <li>
      <a href="../articles/a4_ccf_computation.html">4. Computation of Cancer Cell Fractions</a>
    </li>
    <li>
      <a href="../articles/a5_smoothing.html">5. Smoothing copy number segments</a>
    </li>
    <li>
      <a href="../articles/a6_fragmentation.html">6. Genome fragmentation analysis</a>
    </li>
    <li>
      <a href="../articles/a7_example_MSeq.html">7. Example data analysis</a>
    </li>
    <li>
      <a href="../articles/a8_annotate_variants.html">8. Drivers annotation</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/caravagnalab/CNAqc/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="a3_peaks_detection_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>3. QC analysis via peaks detection</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/caravagnalab/CNAqcvignettes/a3_peaks_detection.Rmd"><code>vignettes/a3_peaks_detection.Rmd</code></a></small>
      <div class="hidden name"><code>a3_peaks_detection.Rmd</code></div>

    </div>

    
    
<p><code>CNAqc</code> can determine if purity and CNA segments “fit well” to mutation data, an hortogonal quality check (QC) metric that can be used to adjust purity/ ploidy.</p>
<p><code>CNAqc</code> matches allelic imbalance of CNA segments to the allelic frequencies of somatic mutations. The package implements a karyotype-weighted linear score which uses the distance between data peaks (empirical), and their theoretical expectation. This score accouts for normal plodiy (germline), and tumour purity/ ploidy. The peaks are determined via kernel density estimation and peak-detection heuristics.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/caravagnalab/CNAqc">CNAqc</a></span><span class="op">)</span>
<span class="co">#&gt; Warning: replacing previous import 'cli::num_ansi_colors' by</span>
<span class="co">#&gt; 'crayon::num_ansi_colors' when loading 'BMix'</span>
<span class="co">#&gt; Warning: replacing previous import 'crayon::%+%' by 'ggplot2::%+%' when loading</span>
<span class="co">#&gt; 'BMix'</span>
<span class="co">#&gt; ✔ Loading BMix, 'Binomial and Beta-Binomial univariate mixtures'. Support : &lt;https://caravagnalab.github.io/BMix/&gt;</span>
<span class="co">#&gt; ✔ Loading CNAqc, 'Copy Number Alteration quality check'. Support : &lt;https://caravagn.github.io/CNAqc/&gt;</span></code></pre></div>
<p>We work with the template dataset.</p>
<pre><code>#&gt;  [ CNAqc - CNA Quality Check ]
#&gt; 
#&gt;    2:2  [n = 7478, L = 1483 Mb] ■■■■■■■■■■■■■■■■■■■■■■■■■■■  { CTCF }
#&gt;    4:2  [n = 1893, L =  331 Mb] ■■■■■■■
#&gt;    3:2  [n = 1625, L =  357 Mb] ■■■■■■
#&gt;    2:1  [n = 1563, L =  420 Mb] ■■■■■■  { TTN }
#&gt;    3:0  [n =  312, L =  137 Mb] ■
#&gt;    2:0  [n =   81, L =   39 Mb]   { TP53 }
#&gt;   16:2  [n =    4, L =    0 Mb] 
#&gt;   25:2  [n =    2, L =    1 Mb] 
#&gt;    3:1  [n =    2, L =    1 Mb] 
#&gt;  106:1  [n =    1, L =    0 Mb] 
#&gt;   26:2  [n =    1, L =    0 Mb] 
#&gt;   99:1  [n =    1, L =    0 Mb]</code></pre>
<p>Peak detection routines are implemented in function <code>analyze_peaks</code>.</p>
<p>The idea is as follows: a segment with <span class="math inline">\(m\)</span> and <span class="math inline">\(M\)</span> copies of the minor and major alleles is consistent to mutation data if the VAF distribution peaks at certain values, which we can compute. Profiling then of the VAF distribution with a peak-detection heuristic allows <code>CNAqc</code> to measure the if peaks match. Large deviance suggests usually wrong purity estimation.</p>
<div id="peak-analysis" class="section level1">
<h1 class="hasAnchor">
<a href="#peak-analysis" class="anchor"></a>Peak analysis</h1>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Run default analysis</span>
<span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="../reference/analyze_peaks.html">analyze_peaks</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="co">#&gt; ℹ Requested karyotypes 1:0, 1:1, 2:1, 2:0, and 2:2. Matching strategy closest.</span>
<span class="co">#&gt; ℹ Found n = 9122 mutations in 2:2, 2:1, 2:0 (skipping those with n &lt; 0 mutations).</span>
<span class="co">#&gt;  [ BMix fit ]</span>
<span class="co">#&gt; ℹ Binomials k_B = 1, 2, 3, and 4, Beta-Binomials k_BB = 0.</span>
<span class="co">#&gt; ✔ Fits to run, n = 8.</span>
<span class="co">#&gt; ℹ Bmix best fit completed in 0.04 mins</span>
<span class="co">#&gt; ── [ BMix ] My BMix model n = 1563 with k = 3 component(s) (3 + 0) ─────────────</span>
<span class="co">#&gt; ● Clusters: π = 53% [Bin 2], 43% [Bin 1], and 4% [Bin 3], with π &gt; 0.</span>
<span class="co">#&gt; ● Binomial Bin 1 with mean = 0.601414994449281.</span>
<span class="co">#&gt; ● Binomial Bin 2 with mean = 0.305589888246352.</span>
<span class="co">#&gt; ● Binomial Bin 3 with mean = 0.0960566837900316.</span>
<span class="co">#&gt; ℹ Score(s): ICL = 12241.07.</span>
<span class="co">#&gt;  [ BMix fit ]</span>
<span class="co">#&gt; ℹ Binomials k_B = 1, 2, 3, and 4, Beta-Binomials k_BB = 0.</span>
<span class="co">#&gt; ✔ Fits to run, n = 8.</span>
<span class="co">#&gt; ℹ Bmix best fit completed in 0 mins</span>
<span class="co">#&gt; ── [ BMix ] My BMix model n = 81 with k = 3 component(s) (3 + 0) ───────────────</span>
<span class="co">#&gt; ● Clusters: π = 89% [Bin 3], 9% [Bin 1], and 2% [Bin 2], with π &gt; 0.</span>
<span class="co">#&gt; ● Binomial Bin 1 with mean = 0.422638818903902.</span>
<span class="co">#&gt; ● Binomial Bin 2 with mean = 0.100774106539128.</span>
<span class="co">#&gt; ● Binomial Bin 3 with mean = 0.88592870546594.</span>
<span class="co">#&gt; ℹ Score(s): ICL = 512.28.</span>
<span class="co">#&gt;  [ BMix fit ]</span>
<span class="co">#&gt; ℹ Binomials k_B = 1, 2, 3, and 4, Beta-Binomials k_BB = 0.</span>
<span class="co">#&gt; ✔ Fits to run, n = 8.</span>
<span class="co">#&gt; ℹ Bmix best fit completed in 0.22 mins</span>
<span class="co">#&gt; ── [ BMix ] My BMix model n = 7478 with k = 4 component(s) (4 + 0) ─────────────</span>
<span class="co">#&gt; ● Clusters: π = 48% [Bin 1], 39% [Bin 3], 9% [Bin 4], and 5% [Bin 2], with π &gt;</span>
<span class="co">#&gt; 0.</span>
<span class="co">#&gt; ● Binomial Bin 1 with mean = 0.440783100017222.</span>
<span class="co">#&gt; ● Binomial Bin 2 with mean = 0.0776183617848511.</span>
<span class="co">#&gt; ● Binomial Bin 3 with mean = 0.488475541938604.</span>
<span class="co">#&gt; ● Binomial Bin 4 with mean = 0.227270208222804.</span>
<span class="co">#&gt; ℹ Score(s): ICL = 59325.34.</span>
<span class="co">#&gt; # A tibble: 6 x 12</span>
<span class="co">#&gt;   mutation_multip… karyotype  peak     x     y counts_per_bin discarded   offset</span>
<span class="co">#&gt;              &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;          &lt;int&gt; &lt;lgl&gt;        &lt;dbl&gt;</span>
<span class="co">#&gt; 1                1 2:1       0.308 0.306 3.60              59 FALSE      0.00245</span>
<span class="co">#&gt; 2                2 2:1       0.616 0.602 2.94              60 FALSE      0.0138 </span>
<span class="co">#&gt; 3                1 2:0       0.445 0.423 0.172              0 FALSE      0.0215 </span>
<span class="co">#&gt; 4                2 2:0       0.89  0.885 7.99               7 FALSE      0.00476</span>
<span class="co">#&gt; 5                1 2:2       0.235 0.24  0.86              65 FALSE     -0.00455</span>
<span class="co">#&gt; 6                2 2:2       0.471 0.46  8.14             625 FALSE      0.0109 </span>
<span class="co">#&gt; # … with 4 more variables: matched &lt;lgl&gt;, weight &lt;dbl&gt;, score &lt;dbl&gt;, QC &lt;chr&gt;</span>
<span class="co">#&gt; ✔ Peak detection PASS with r = 0.0041148739213522 and tolerance e = 0.06</span></code></pre></div>
<p><code>CNAqc</code> analyze LOH regions (A, AA), diploid regions (AB), and amplification regions (AAB, AABB). These correspond to <code>'1:1'</code>, <code>'2:1'</code>, <code>'2:0'</code> and <code>'2:2'</code> in “Major:minor” notation. Karyotypes are subset by their size (normalized for the number of input mutations), and by default karyotypes smaller than 5% of the actual mutational burden are not considered</p>
<p>A Kernel-density method (unitary adjustment, Gaussian kernel) is used to smooth the data distribution, and the <a href="https://cran.rstudio.com/web/packages/peakPick/index.html">peakPick: Peak Picking Methods Inspired by Biological Data</a> package is used to determine peaks in the smoothed density. Peaks below a mnimum density (noise and miscalled segments) are filtered, and the others are matched to a predefined location with some tolerance (e.g., plus/minus <code>0.5 * epsilon</code>, where <code>epsilon = 0.015</code> is the default).</p>
<p>Theis analysis produces a set of scores that account for karyotype size and peaks offset, and that can be combined into a linear model to compute an overall QC metrics, called <code>rho</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
<span class="co">#&gt; ── [ CNAqc ]  n = 12963 mutations in 267 segments (267 clonal + 0 subclonal). Ge</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;    2:2  [n = 7478, L = 1483 Mb] ■■■■■■■■■■■■■■■■■■■■■■■■■■■  { CTCF }</span>
<span class="co">#&gt;    4:2  [n = 1893, L =  331 Mb] ■■■■■■■</span>
<span class="co">#&gt;    3:2  [n = 1625, L =  357 Mb] ■■■■■■</span>
<span class="co">#&gt;    2:1  [n = 1563, L =  420 Mb] ■■■■■■  { TTN }</span>
<span class="co">#&gt;    3:0  [n =  312, L =  137 Mb] ■</span>
<span class="co">#&gt;    2:0  [n =   81, L =   39 Mb]   { TP53 }</span>
<span class="co">#&gt;   16:2  [n =    4, L =    0 Mb] </span>
<span class="co">#&gt;   25:2  [n =    2, L =    1 Mb] </span>
<span class="co">#&gt;    3:1  [n =    2, L =    1 Mb] </span>
<span class="co">#&gt;  106:1  [n =    1, L =    0 Mb] </span>
<span class="co">#&gt;   26:2  [n =    1, L =    0 Mb] </span>
<span class="co">#&gt;   99:1  [n =    1, L =    0 Mb]</span>
<span class="co">#&gt; ℹ Sample Purity: 89% ~ Ploidy: 4.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ──  PASS  Peaks QC closest: % 100 with q = 0.0041148739213522</span>
<span class="co">#&gt; ℹ 2:1 ~ n = 1563  (17%) →  PASS  0.002    PASS  0.014</span>
<span class="co">#&gt; ℹ 2:0 ~ n = 81    ( 1%) →  PASS  0.022    PASS  0.005</span>
<span class="co">#&gt; ℹ 2:2 ~ n = 7478  (82%) →  PASS  -0.005   PASS  0.011</span></code></pre></div>
<p>A summary table is stored inside the named list <code>peaks_analysis</code>.</p>
</div>
<div id="plotting-results" class="section level1">
<h1 class="hasAnchor">
<a href="#plotting-results" class="anchor"></a>Plotting results</h1>
<p>For every karyotype, a plot with the estimated KDE and the matched peaks is available (assembled <code>ggpubr</code> figure with); gray panels represent karyotypes that have not been used.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_peaks_analysis.html">plot_peaks_analysis</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></code></pre></div>
<p><img src="a3_peaks_detection_files/figure-html/unnamed-chunk-5-1.png" width="1056"></p>
<p>Individual karyotypes plots are available inside the named lists <code>peaks_analysis$plots</code>, named afte each required karyotype.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Tetraploid segments</span>
<span class="va">x</span><span class="op">$</span><span class="va">peaks_analysis</span><span class="op">$</span><span class="va">plots</span><span class="op">$</span><span class="va">`2:2`</span>
<span class="co">#&gt; NULL</span></code></pre></div>
<p>You can integrate plots from QC analysis with data.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">cowplot</span><span class="fu">::</span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html">plot_grid</a></span><span class="op">(</span>
  <span class="fu"><a href="../reference/plot_peaks_analysis.html">plot_peaks_analysis</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,
  <span class="fu"><a href="../reference/plot_segments.html">plot_segments</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,
  rel_heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.8</span>, <span class="fl">1</span><span class="op">)</span>,
  nrow <span class="op">=</span> <span class="fl">2</span>
<span class="op">)</span>
<span class="co">#&gt; Scale for 'fill' is already present. Adding another scale for 'fill', which</span>
<span class="co">#&gt; will replace the existing scale.</span></code></pre></div>
<p><img src="a3_peaks_detection_files/figure-html/unnamed-chunk-7-1.png" width="1056"></p>
</div>
<div id="summary-results-and-quality-check-qc" class="section level1">
<h1 class="hasAnchor">
<a href="#summary-results-and-quality-check-qc" class="anchor"></a>Summary results and Quality Check (QC)</h1>
<p>The summary technical table is available as <code>peaks_analysis$matches</code> inside <code>x</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span><span class="op">$</span><span class="va">peaks_analysis</span><span class="op">$</span><span class="va">matches</span>
<span class="co">#&gt; # A tibble: 6 x 12</span>
<span class="co">#&gt;   mutation_multip… karyotype  peak     x     y counts_per_bin discarded   offset</span>
<span class="co">#&gt;              &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;          &lt;int&gt; &lt;lgl&gt;        &lt;dbl&gt;</span>
<span class="co">#&gt; 1                1 2:1       0.308 0.306 3.60              59 FALSE      0.00245</span>
<span class="co">#&gt; 2                2 2:1       0.616 0.602 2.94              60 FALSE      0.0138 </span>
<span class="co">#&gt; 3                1 2:0       0.445 0.423 0.172              0 FALSE      0.0215 </span>
<span class="co">#&gt; 4                2 2:0       0.89  0.885 7.99               7 FALSE      0.00476</span>
<span class="co">#&gt; 5                1 2:2       0.235 0.24  0.86              65 FALSE     -0.00455</span>
<span class="co">#&gt; 6                2 2:2       0.471 0.46  8.14             625 FALSE      0.0109 </span>
<span class="co">#&gt; # … with 4 more variables: matched &lt;lgl&gt;, weight &lt;dbl&gt;, score &lt;dbl&gt;, QC &lt;chr&gt;</span></code></pre></div>
<p>The table reports several information. The following might be of some use after the analysis:</p>
<ul>
<li>
<code>mutation_multiplicity</code> and <code>karyotype</code>, which are the number of copies of the mutation, and the segment’s karyotype. Each segment with <code>discarded = FALSE</code> has been analysed;</li>
<li>
<code>peak</code>, <code>x</code>, <code>y</code> report where the expected peak should be found, and where it has been found (<code>x</code> and <code>y</code>);</li>
<li>
<code>offset</code>, <code>weight</code> and <code>score</code> that report the factors of the final <code>score</code>;</li>
<li>
<code>QC</code> that reports if the peak is considered matched.</li>
</ul>
<p>The overall <code>QC</code> result - <code>"PASS"/"FAIL"</code> - is available in <code>x</code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span><span class="op">$</span><span class="va">peaks_analysis</span><span class="op">$</span><span class="va">QC</span>
<span class="co">#&gt; [1] "PASS"</span></code></pre></div>
<p>You can visually summarise the result of the QC analysis, for both peaks and <a href="https://caravagn.github.io/CNAqc/articles/ccf_computation.html">CCF computation</a>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_qc.html">plot_qc</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></code></pre></div>
<p><img src="a3_peaks_detection_files/figure-html/unnamed-chunk-10-1.png" width="288"></p>
<p>Here since CCF have not been computed, the only available QC tests are for peak-detection.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://www.caravagnalab.org">Giulio Caravagna</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
